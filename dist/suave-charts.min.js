(function(){var Svg$$module$target$coffeescript$svg,module$target$coffeescript$svg=Svg$$module$target$coffeescript$svg=function(){function d(c,b,a){this.margin=a;a=b.split(":");b=a[0];a=a[1];this.aspectRatio=[parseInt(b),parseInt(a)];this.domElement="string"===typeof c?document.querySelector(c):c;this.container=d3.select(this.domElement).append("svg").attr("preserveAspectRatio","xMinYMin");this.chart=this.container.append("g")}d.prototype.resize=function(c){var b,a;null==c&&(c=this.margin);a=this.domElement.offsetWidth;
b=a/this.aspectRatio[0]*this.aspectRatio[1];this.width=a-c.left-c.right;this.height=b-c.bottom-c.top;this.container.attr("width",a).attr("height",b);return this.chart.attr("transform","translate("+c.left+","+c.top+")")};return d}();var defaultBarOptions$$module$target$coffeescript$defaults,defaultDonutOptions$$module$target$coffeescript$defaults,defaultHistogramOptions$$module$target$coffeescript$defaults,defaultLineOptions$$module$target$coffeescript$defaults,mergeOptions$$module$target$coffeescript$defaults;mergeOptions$$module$target$coffeescript$defaults=function(d,c){var b,a;a={};for(b in d)a[b]=d[b];for(b in c)a[b]=c[b];return a};
defaultLineOptions$$module$target$coffeescript$defaults={autoMargins:!0,aspectRatio:"16:9",dotSize:6,grid:!0,xScale:"ordinal",yScale:"linear",smoothLines:!1,stack:!1,tooltips:!0,xLabelFormat:null,yLabelFormat:null,tooltipFormat:function(d){return d3.format(",.0f")(d)},ticks:10,yTicks:10,legend:!1,margin:{top:50,bottom:50,right:80,left:80}};
defaultBarOptions$$module$target$coffeescript$defaults={aspectRatio:"16:9",grid:!0,tooltips:!0,layout:"vertical",xLabelFormat:null,yLabelFormat:null,tooltipFormat:function(d){return d3.format(",.0f")(d)},barSpacing:.1,margin:{top:50,bottom:50,right:80,left:80}};
defaultHistogramOptions$$module$target$coffeescript$defaults={aspectRatio:"16:9",grid:!0,tooltips:!0,layout:"vertical",xLabelFormat:null,yLabelFormat:null,tooltipFormat:function(d){return d3.format(",.0f")(d)},bins:20,ticks:20,domain:null,margin:{top:50,bottom:50,right:80,left:80}};defaultDonutOptions$$module$target$coffeescript$defaults={aspectRatio:"16:9",holeSize:.5,margin:{top:0,bottom:0,right:0,left:0}};
var module$target$coffeescript$defaults={mergeOptions:mergeOptions$$module$target$coffeescript$defaults,lineOptions:defaultLineOptions$$module$target$coffeescript$defaults,barOptions:defaultBarOptions$$module$target$coffeescript$defaults,histogramOptions:defaultHistogramOptions$$module$target$coffeescript$defaults,donutOptions:defaultDonutOptions$$module$target$coffeescript$defaults};var AbstractChart$$module$target$coffeescript$abstract_chart,Svg$$module$target$coffeescript$abstract_chart,defaults$$module$target$coffeescript$abstract_chart;defaults$$module$target$coffeescript$abstract_chart=module$target$coffeescript$defaults;Svg$$module$target$coffeescript$abstract_chart=module$target$coffeescript$svg;
var module$target$coffeescript$abstract_chart=AbstractChart$$module$target$coffeescript$abstract_chart=function(){function d(c,b,a){null==b&&(b={});null==a&&(a={});this.options=defaults$$module$target$coffeescript$abstract_chart.mergeOptions(b,a);this.svg=new Svg$$module$target$coffeescript$abstract_chart(c,this.options.aspectRatio,this.options.margin);this.listenerBound=!1;this.axisLabelPadding=10}d.prototype.waitToBeInDom=function(c){return document.body.contains(this.svg.container[0][0])?c():setTimeout(c,
100)};d.prototype.draw=function(){if(!this.listenerBound)return window.addEventListener("resize",this.render),this.listenerBound=!0};d.prototype.remove=function(){var c,b;window.removeEventListener("resize",this.render);null!=this.tip&&this.tip.remove();c=this.svg.domElement;for(b=[];c.firstChild;)b.push(c.removeChild(c.firstChild));return b};return d}();var filterTicks$$module$target$coffeescript$filter_ticks,module$target$coffeescript$filter_ticks=filterTicks$$module$target$coffeescript$filter_ticks=function(d,c,b){var a,A;return"ordinal"===b?(a=c.domain(),A=Math.round(a.length/(d-2)),a.filter(function(b,c){return 0===c||b===a[a.length-1]?!0:0===c%A})):c.ticks(d)};var Axes$$module$target$coffeescript$axes,filterTicks$$module$target$coffeescript$axes,bind$$module$target$coffeescript$axes=function(d,c){return function(){return d.apply(c,arguments)}};filterTicks$$module$target$coffeescript$axes=module$target$coffeescript$filter_ticks;
var module$target$coffeescript$axes=Axes$$module$target$coffeescript$axes=function(){function d(c,b,a,d,w){this.xScale=b;this.yScale=a;this.options=d;this.axisLabelPadding=w;this.newAxis=bind$$module$target$coffeescript$axes(this.newAxis,this);this.xAxisSelection=c.append("g").attr("class","x axis");this.yAxisSelection=c.append("g").attr("class","y axis");this.xAxis=this.newAxis(this.xScale,"bottom");this.yAxis=this.newAxis(this.yScale,"left")}d.prototype.draw=function(c,b){var a,d;this.xAxisSelection.attr("transform",
"translate(0,"+b+")");this.options.grid&&(this.xAxis.tickSize(-b,0),this.yAxis.tickSize(-c,0));this.options.xLabelInterval?(d=function(){switch(this.options.xLabelInterval){case "seconds":return d3.time.seconds;case "minutes":return d3.time.minutes;case "hours":return d3.time.hours;case "days":return d3.time.days;case "months":return d3.time.months;case "years":return d3.time.years}}.call(this),a=null!=this.options.tickStepSize?this.options.tickStepSize:1,this.xAxis.ticks(d,a)):null!=this.options.ticks&&
0<this.options.ticks&&(d=filterTicks$$module$target$coffeescript$axes(this.options.ticks,this.xScale,this.options.xScale),this.xAxis.tickValues(d));this.yAxis.ticks(this.options.yTicks);this.xAxisSelection.call(this.xAxis);return this.yAxisSelection.call(this.yAxis)};d.prototype.newAxis=function(c,b){return d3.svg.axis().scale(c).orient(b).tickPadding(this.axisLabelPadding)};return d}();var MarginCalculator$$module$target$coffeescript$margin_calculator,module$target$coffeescript$margin_calculator=MarginCalculator$$module$target$coffeescript$margin_calculator=function(){function d(c){this.svg=c}d.prototype.calcLeftMargin=function(c,b,a,d){var w;null==a&&(a="y");null==d&&(d=20);a=this.svg.chart.append("g").attr("class",a+" axis").attr("opacity",0);a.call(c);c=a.selectAll("text").sort(function(a,b){return b.toString().length-a.toString().length});b=1<=c.length&&1<=c[0].length?(w=c[0][0].getBBox(),
Math.round(w.width)+d):b;a.remove();return b};return d}();var Tooltip$$module$target$coffeescript$tooltip,bind$$module$target$coffeescript$tooltip=function(d,c){return function(){return d.apply(c,arguments)}},module$target$coffeescript$tooltip=Tooltip$$module$target$coffeescript$tooltip=function(){function d(c){this.remove=bind$$module$target$coffeescript$tooltip(this.remove,this);this.hide=bind$$module$target$coffeescript$tooltip(this.hide,this);this.show=bind$$module$target$coffeescript$tooltip(this.show,this);this.html=bind$$module$target$coffeescript$tooltip(this.html,
this);this.cssClass="suave-tooltip";this.tip=d3.select(c.createElement("div"));this.tip.attr("class",this.cssClass);c.body.appendChild(this.tip.node())}d.prototype.html=function(c){return this.tip.html(c)};d.prototype.show=function(c){c=this.offset(c);this.tip.attr("class",this.cssClass+" show");return this.tip.style({position:"absolute",top:c.top+"px",left:c.left+"px"})};d.prototype.hide=function(){return this.tip.attr("class",this.cssClass)};d.prototype.remove=function(){return this.tip.remove()};
d.prototype.offset=function(c){var b,a;b=c.getBoundingClientRect();c=b.left+(b.right-b.left)/2;a=this.tip.node().getBoundingClientRect();return{top:b.top-(a.bottom-a.top+10)+window.scrollY,left:c-(a.right-a.left)/2+window.scrollX}};return d}();var AbstractChart$$module$target$coffeescript$bar_chart,BarChart$$module$target$coffeescript$bar_chart,MarginCalculator$$module$target$coffeescript$bar_chart,Tooltip$$module$target$coffeescript$bar_chart,defaultBarOptions$$module$target$coffeescript$bar_chart,filterTicks$$module$target$coffeescript$bar_chart,bind$$module$target$coffeescript$bar_chart=function(d,c){return function(){return d.apply(c,arguments)}},extend$$module$target$coffeescript$bar_chart=function(d,c){function b(){this.constructor=
d}for(var a in c)hasProp$$module$target$coffeescript$bar_chart.call(c,a)&&(d[a]=c[a]);b.prototype=c.prototype;d.prototype=new b;d.__super__=c.prototype;return d},hasProp$$module$target$coffeescript$bar_chart={}.hasOwnProperty;AbstractChart$$module$target$coffeescript$bar_chart=module$target$coffeescript$abstract_chart;MarginCalculator$$module$target$coffeescript$bar_chart=module$target$coffeescript$margin_calculator;Tooltip$$module$target$coffeescript$bar_chart=module$target$coffeescript$tooltip;
defaultBarOptions$$module$target$coffeescript$bar_chart=module$target$coffeescript$defaults.barOptions;filterTicks$$module$target$coffeescript$bar_chart=module$target$coffeescript$filter_ticks;
var module$target$coffeescript$bar_chart=BarChart$$module$target$coffeescript$bar_chart=function(d){function c(b,a){null==a&&(a={});this.render=bind$$module$target$coffeescript$bar_chart(this.render,this);this.sum=bind$$module$target$coffeescript$bar_chart(this.sum,this);c.__super__.constructor.call(this,b,defaultBarOptions$$module$target$coffeescript$bar_chart,a);this.calc=new MarginCalculator$$module$target$coffeescript$bar_chart(this.svg);this.x=d3.scale.ordinal();this.y=d3.scale.linear();this.xAxis=
d3.svg.axis().scale(this.x).tickFormat(this.options.xLabelFormat).outerTickSize(0).tickPadding(this.axisLabelPadding);this.yAxis=d3.svg.axis().scale(this.y).tickFormat(this.options.yLabelFormat).tickPadding(this.axisLabelPadding);this.xAxis.orient("bottom");this.yAxis.orient("left");this.tipPadding=20}extend$$module$target$coffeescript$bar_chart(c,d);c.prototype.sum=function(){var b;b=this.y.domain()[1];this.bars.each(function(a){return b-=a.value});return b};c.prototype.render=function(){var b,a,
c,d,f,h,m,k;this.svg.resize();this.x.rangeRoundBands([0,this.svg.width]);a={xTransform:"translate(0, "+this.svg.height+")",yTransform:"",groupsTransform:function(a){return function(b){return"translate("+a.x(b)+", 0)"}}(this),xRange:[0,this.svg.width],yRange:[this.svg.height,0],barX:function(a){return function(b){return a.x(b.label)}}(this),barY:function(a){return function(b){return a.y(b.value)}}(this),barWidth:function(a){return function(){return a.x.rangeBand()}}(this),barHeight:function(a){return function(b){return a.svg.height-
a.y(b.value)}}(this)};this.x.rangeRoundBands(a.xRange,this.options.barSpacing);this.y.range(a.yRange);this.xAxisSelection.attr("transform",a.xTransform).call(this.xAxis);this.yAxisSelection.attr("transform",a.yTransform).call(this.yAxis);this.bars.attr("x",a.barX).attr("y",a.barY).attr("width",a.barWidth).attr("height",a.barHeight);this.totalBar.attr("x",a.barX).attr("y",a.barY).attr("width",a.barWidth).attr("height",a.barHeight);this.totalBarBackground.attr("x",a.barX).attr("y",0).attr("width",a.barWidth).attr("height",
this.y.range()[0]);this.tooltips.attr("x",function(b){return function(b){return a.barX(b)+.5*a.barWidth()}}(this)).attr("y",function(b){return function(c){return Math.min(a.barY(c)-b.tipPadding,b.svg.height-b.tipPadding)}}(this)).text(function(a){return function(b){return a.options.tooltipFormat(b.value)}}(this));this.totalBarTooltip.attr("x",function(b){return function(b){return a.barX(b)+.5*a.barWidth()}}(this)).attr("y",function(b){return function(c){return Math.min(a.barY(c)-b.tipPadding,b.svg.height-
b.tipPadding)}}(this)).text(function(a){return function(b){return a.options.tooltipFormat(b.value)}}(this));h=this.totalBar;m=this.totalBarTooltip;k=this.y;c=this.sum;f=this.options.tooltipFormat;d=this.tipPadding;b=d3.behavior.drag().on("drag",function(b){var e,g,l;e=c();e=Math.min(Math.round(k.invert(d3.event.y)-b.value),e);e=Math.max(0,Math.min(b.value+e,k.domain()[1]));b.value=e;d3.select(this).attr("cy",k(e));l=d3.select(this.parentNode);l.select("rect").attr("height",a.barHeight({value:e})).attr("y",
a.barY({value:e}));l.select("text").attr("y",function(b){return a.barY(b)-d}).text(f(e));g=c();h.each(function(a){return a.value=g});h.attr("height",a.barHeight({value:g})).attr("y",a.barY({value:g}));m.attr("y",a.barY({value:g})-d).text(f(g));return this.dispatchEvent(new CustomEvent("goalChartChanged",{detail:b,bubbles:!0}))});return this.dots.attr("cx",function(b){return a.barX(b)+.5*a.barWidth()}).attr("cy",function(b){return a.barY(b)+2.5}).attr("class","drag-handle").call(b)};c.prototype.draw=
function(b){c.__super__.draw.call(this);return this.waitToBeInDom(function(a){return function(){return a.drawInternal(b)}}(this))};c.prototype.drawInternal=function(b){var a;a=[{value:b.bars.reduce(function(a,b){return a+b},0),label:b.domainLabel}];b.bars.forEach(function(c,d){return a.push({value:c,label:b.labels[d]})});this.y.domain(b.domain);this.x.domain(a.map(function(a){return a.label}));this.options.margin.left=this.calc.calcLeftMargin(this.yAxis,this.options.margin.left);this.xAxisSelection=
this.svg.chart.append("g").attr("class","x axis");this.yAxisSelection=this.svg.chart.append("g").attr("class","y axis");this.groups=this.svg.chart.selectAll(".barGroup").data(a).enter().append("g").attr("class",function(a,b){return"barGroup barGroup-"+b+" "+a.label});this.barGroups=this.groups.append("g").attr("class",function(a,b){return"bar bar-"+b});this.barGroupsWithoutTotal=this.barGroups.filter(function(a,b){return 0!==b});this.bars=this.barGroupsWithoutTotal.append("rect");this.dots=this.barGroupsWithoutTotal.append("circle").attr("r",
5);this.tooltips=this.barGroupsWithoutTotal.append("text").attr("text-anchor","middle");this.totalBarGroup=this.barGroups.filter(function(a,b){return 0===b}).datum({value:this.sum(),label:b.domainLabel}).append("g").attr("class","total");this.totalBarBackground=this.totalBarGroup.append("rect").attr("class","background");this.totalBar=this.totalBarGroup.append("rect").attr("class","sum");this.totalBarTooltip=this.totalBarGroup.append("text").attr("text-anchor","middle");return this.render()};return c}(AbstractChart$$module$target$coffeescript$bar_chart);var AbstractChart$$module$target$coffeescript$donut_chart,DonutChart$$module$target$coffeescript$donut_chart,defaultDonutOptions$$module$target$coffeescript$donut_chart,bind$$module$target$coffeescript$donut_chart=function(d,c){return function(){return d.apply(c,arguments)}},extend$$module$target$coffeescript$donut_chart=function(d,c){function b(){this.constructor=d}for(var a in c)hasProp$$module$target$coffeescript$donut_chart.call(c,a)&&(d[a]=c[a]);b.prototype=c.prototype;d.prototype=new b;d.__super__=
c.prototype;return d},hasProp$$module$target$coffeescript$donut_chart={}.hasOwnProperty;AbstractChart$$module$target$coffeescript$donut_chart=module$target$coffeescript$abstract_chart;defaultDonutOptions$$module$target$coffeescript$donut_chart=module$target$coffeescript$defaults.donutOptions;
var module$target$coffeescript$donut_chart=DonutChart$$module$target$coffeescript$donut_chart=function(d){function c(b,a){null==a&&(a={});this.drawInternal=bind$$module$target$coffeescript$donut_chart(this.drawInternal,this);this.draw=bind$$module$target$coffeescript$donut_chart(this.draw,this);this.render=bind$$module$target$coffeescript$donut_chart(this.render,this);c.__super__.constructor.call(this,b,defaultDonutOptions$$module$target$coffeescript$donut_chart,a);this.options.margin={top:0,bottom:0,
left:0,right:0};this.arc=d3.svg.arc();this.pie=d3.layout.pie().sort(null).value(function(a){return a[1]})}extend$$module$target$coffeescript$donut_chart(c,d);c.prototype.render=function(){var b;this.svg.resize();b=Math.min(this.svg.width,this.svg.height)/2;this.svg.chart.attr("transform","translate("+this.svg.width/2+", "+this.svg.height/2+")");this.arc.innerRadius(b).outerRadius(b-b*this.options.holeSize);this.arcs.attr("d",this.arc);return this.labels.attr("transform",function(a){return function(b){return"translate("+
a.arc.centroid(b)+")"}}(this))};c.prototype.draw=function(b){c.__super__.draw.call(this);return this.waitToBeInDom(function(a){return function(){return a.drawInternal(b)}}(this))};c.prototype.drawInternal=function(b){this.enter=this.svg.chart.selectAll(".arc").data(this.pie(b)).enter().append("g").attr("class",function(a,b){return"arc arc-"+b+" arc-"+a.data[0]});this.arcs=this.enter.append("path");this.labels=this.enter.append("text").attr("dy",".35em").text(function(a){return a.data[0]});return this.render()};
return c}(AbstractChart$$module$target$coffeescript$donut_chart);var AbstractChart$$module$target$coffeescript$goals_chart,GoalsChart$$module$target$coffeescript$goals_chart,MarginCalculator$$module$target$coffeescript$goals_chart,Tooltip$$module$target$coffeescript$goals_chart,defaultBarOptions$$module$target$coffeescript$goals_chart,filterTicks$$module$target$coffeescript$goals_chart,bind$$module$target$coffeescript$goals_chart=function(d,c){return function(){return d.apply(c,arguments)}},extend$$module$target$coffeescript$goals_chart=function(d,c){function b(){this.constructor=
d}for(var a in c)hasProp$$module$target$coffeescript$goals_chart.call(c,a)&&(d[a]=c[a]);b.prototype=c.prototype;d.prototype=new b;d.__super__=c.prototype;return d},hasProp$$module$target$coffeescript$goals_chart={}.hasOwnProperty;AbstractChart$$module$target$coffeescript$goals_chart=module$target$coffeescript$abstract_chart;MarginCalculator$$module$target$coffeescript$goals_chart=module$target$coffeescript$margin_calculator;Tooltip$$module$target$coffeescript$goals_chart=module$target$coffeescript$tooltip;
defaultBarOptions$$module$target$coffeescript$goals_chart=module$target$coffeescript$defaults.barOptions;filterTicks$$module$target$coffeescript$goals_chart=module$target$coffeescript$filter_ticks;
var module$target$coffeescript$goals_chart=GoalsChart$$module$target$coffeescript$goals_chart=function(d){function c(b,a){null==a&&(a={});this.render=bind$$module$target$coffeescript$goals_chart(this.render,this);this.sum=bind$$module$target$coffeescript$goals_chart(this.sum,this);c.__super__.constructor.call(this,b,defaultBarOptions$$module$target$coffeescript$goals_chart,a);this.calc=new MarginCalculator$$module$target$coffeescript$goals_chart(this.svg);this.x=d3.scale.ordinal();this.y=d3.scale.linear();
this.xAxis=d3.svg.axis().scale(this.x).tickFormat(this.options.xLabelFormat).outerTickSize(0).tickPadding(this.axisLabelPadding);this.yAxis=d3.svg.axis().scale(this.y).tickFormat(this.options.yLabelFormat).tickPadding(this.axisLabelPadding);this.xAxis.orient("bottom");this.yAxis.orient("left");this.tipPadding=20}extend$$module$target$coffeescript$goals_chart(c,d);c.prototype.sum=function(){var b;b=this.y.domain()[1];this.bars.each(function(a){return b-=a.value});return b};c.prototype.render=function(){var b,
a,c,d,f,h,m,k;this.svg.resize();this.x.rangeRoundBands([0,this.svg.width]);a={xTransform:"translate(0, "+this.svg.height+")",yTransform:"",groupsTransform:function(a){return function(b){return"translate("+a.x(b)+", 0)"}}(this),xRange:[0,this.svg.width],yRange:[this.svg.height,0],barX:function(a){return function(b){return a.x(b.label)}}(this),barY:function(a){return function(b){return a.y(b.value)}}(this),barWidth:function(a){return function(){return a.x.rangeBand()}}(this),barHeight:function(a){return function(b){return a.svg.height-
a.y(b.value)}}(this)};this.x.rangeRoundBands(a.xRange,this.options.barSpacing);this.y.range(a.yRange);this.xAxisSelection.attr("transform",a.xTransform).call(this.xAxis);this.yAxisSelection.attr("transform",a.yTransform).call(this.yAxis);this.bars.attr("x",a.barX).attr("y",a.barY).attr("width",a.barWidth).attr("height",a.barHeight);this.totalBar.attr("x",a.barX).attr("y",a.barY).attr("width",a.barWidth).attr("height",a.barHeight);this.totalBarBackground.attr("x",a.barX).attr("y",0).attr("width",a.barWidth).attr("height",
this.y.range()[0]);this.tooltips.attr("x",function(b){return function(b){return a.barX(b)+.5*a.barWidth()}}(this)).attr("y",function(b){return function(c){return Math.min(a.barY(c)-b.tipPadding,b.svg.height-b.tipPadding)}}(this)).text(function(a){return function(b){return a.options.tooltipFormat(b.value)}}(this));this.totalBarTooltip.attr("x",function(b){return function(b){return a.barX(b)+.5*a.barWidth()}}(this)).attr("y",function(b){return function(c){return Math.min(a.barY(c)-b.tipPadding,b.svg.height-
b.tipPadding)}}(this)).text(function(a){return function(b){return a.options.tooltipFormat(b.value)}}(this));h=this.totalBar;m=this.totalBarTooltip;k=this.y;c=this.sum;f=this.options.tooltipFormat;d=this.tipPadding;b=d3.behavior.drag().on("drag",function(b){var e,g,l;e=c();e=Math.min(Math.round(k.invert(d3.event.y)-b.value),e);e=Math.max(0,Math.min(b.value+e,k.domain()[1]));b.value=e;d3.select(this).attr("cy",k(e));l=d3.select(this.parentNode);l.select("rect").attr("height",a.barHeight({value:e})).attr("y",
a.barY({value:e}));l.select("text").attr("y",function(b){return a.barY(b)-d}).text(f(e));g=c();h.each(function(a){return a.value=g});h.attr("height",a.barHeight({value:g})).attr("y",a.barY({value:g}));m.attr("y",a.barY({value:g})-d).text(f(g));return this.dispatchEvent(new CustomEvent("goalChartChanged",{detail:b,bubbles:!0}))});return this.dots.attr("cx",function(b){return a.barX(b)+.5*a.barWidth()}).attr("cy",function(b){return a.barY(b)+2.5}).attr("class","drag-handle").call(b)};c.prototype.draw=
function(b){c.__super__.draw.call(this);return this.waitToBeInDom(function(a){return function(){return a.drawInternal(b)}}(this))};c.prototype.drawInternal=function(b){var a;a=[{value:b.bars.reduce(function(a,b){return a+b},0),label:b.domainLabel}];b.bars.forEach(function(c,d){return a.push({value:c,label:b.labels[d]})});this.y.domain(b.domain);this.x.domain(a.map(function(a){return a.label}));this.options.margin.left=this.calc.calcLeftMargin(this.yAxis,this.options.margin.left);this.xAxisSelection=
this.svg.chart.append("g").attr("class","x axis");this.yAxisSelection=this.svg.chart.append("g").attr("class","y axis");this.groups=this.svg.chart.selectAll(".barGroup").data(a).enter().append("g").attr("class",function(a,b){return"barGroup barGroup-"+b+" "+a.label});this.barGroups=this.groups.append("g").attr("class",function(a,b){return"bar bar-"+b});this.barGroupsWithoutTotal=this.barGroups.filter(function(a,b){return 0!==b});this.bars=this.barGroupsWithoutTotal.append("rect");this.dots=this.barGroupsWithoutTotal.append("circle").attr("r",
5);this.tooltips=this.barGroupsWithoutTotal.append("text").attr("text-anchor","middle");this.totalBarGroup=this.barGroups.filter(function(a,b){return 0===b}).datum({value:this.sum(),label:b.domainLabel}).append("g").attr("class","total");this.totalBarBackground=this.totalBarGroup.append("rect").attr("class","background");this.totalBar=this.totalBarGroup.append("rect").attr("class","sum");this.totalBarTooltip=this.totalBarGroup.append("text").attr("text-anchor","middle");return this.render()};return c}(AbstractChart$$module$target$coffeescript$goals_chart);var AbstractChart$$module$target$coffeescript$histogram,Histogram$$module$target$coffeescript$histogram,MarginCalculator$$module$target$coffeescript$histogram,Tooltip$$module$target$coffeescript$histogram,defaultHistogramOptions$$module$target$coffeescript$histogram,bind$$module$target$coffeescript$histogram=function(d,c){return function(){return d.apply(c,arguments)}},extend$$module$target$coffeescript$histogram=function(d,c){function b(){this.constructor=d}for(var a in c)hasProp$$module$target$coffeescript$histogram.call(c,
a)&&(d[a]=c[a]);b.prototype=c.prototype;d.prototype=new b;d.__super__=c.prototype;return d},hasProp$$module$target$coffeescript$histogram={}.hasOwnProperty;AbstractChart$$module$target$coffeescript$histogram=module$target$coffeescript$abstract_chart;MarginCalculator$$module$target$coffeescript$histogram=module$target$coffeescript$margin_calculator;Tooltip$$module$target$coffeescript$histogram=module$target$coffeescript$tooltip;defaultHistogramOptions$$module$target$coffeescript$histogram=module$target$coffeescript$defaults.histogramOptions;
var module$target$coffeescript$histogram=Histogram$$module$target$coffeescript$histogram=function(d){function c(b,a){null==a&&(a={});this.render=bind$$module$target$coffeescript$histogram(this.render,this);c.__super__.constructor.call(this,b,defaultHistogramOptions$$module$target$coffeescript$histogram,a);this.calc=new MarginCalculator$$module$target$coffeescript$histogram(this.svg);this.x=d3.scale.linear();this.y=d3.scale.linear();this.xAxis=d3.svg.axis().scale(this.x).outerTickSize(0).tickFormat(this.options.xLabelFormat).tickPadding(this.axisLabelPadding);
this.yAxis=d3.svg.axis().scale(this.y).tickFormat(this.options.yLabelFormat).tickPadding(this.axisLabelPadding);"vertical"===this.options.layout?(this.xAxis.orient("bottom"),this.yAxis.orient("left")):(this.xAxis.orient("left"),this.yAxis.orient("bottom"))}extend$$module$target$coffeescript$histogram(c,d);c.prototype.render=function(){var b,a;this.svg.resize();b=this.histogram[0];a="vertical"===this.options.layout?(this.options.grid?this.yAxis.tickSize(-this.svg.width,0):void 0,{xRange:[0,this.svg.width],
yRange:[this.svg.height,0],xTransform:"translate(0, "+this.svg.height+")",yTransform:"",barsTransform:function(a){return function(b){return"translate("+a.x(b.x)+", "+a.y(b.y)+")"}}(this),barWidth:function(a){return function(c){return a.x(b.x+b.dx)-a.x(b.x)-1}}(this),barHeight:function(a){return function(b){return a.svg.height-a.y(b.y)}}(this)}):(this.options.grid?this.yAxis.tickSize(-this.svg.height,0):void 0,{xRange:[0,this.svg.height],yRange:[0,this.svg.width],xTransform:"",yTransform:"translate(0, "+
this.svg.height+")",barsTransform:function(a){return function(b){return"translate(0, "+a.x(b.x)+")"}}(this),barWidth:function(a){return function(b){return a.y(b.y)}}(this),barHeight:function(a){return function(c){return a.x(b.x+b.dx)-a.x(b.x)-1}}(this)});this.x.range(a.xRange);this.y.range(a.yRange);this.xAxisSelection.attr("transform",a.xTransform).call(this.xAxis);this.yAxisSelection.attr("transform",a.yTransform).call(this.yAxis);this.bars.attr("transform",a.barsTransform);return this.rects.attr("width",
a.barWidth).attr("height",a.barHeight)};c.prototype.draw=function(b){c.__super__.draw.call(this);return this.waitToBeInDom(function(a){return function(){return a.drawInternal(b)}}(this))};c.prototype.drawInternal=function(b){var a,c,d,f;a=d3.layout.histogram();this.options.domain?(this.x.domain(this.options.domain),this.histogram=a.bins(this.x.ticks(this.options.bins))(b.values),this.xAxis.ticks(this.options.bins)):(this.x.domain(d3.extent(b.values)).nice(),c=this.x.ticks(this.options.bins),this.histogram=
a.bins(c)(b.values),this.xAxis.tickValues(c));this.y.domain([0,d3.max(this.histogram,function(a){return a.y})]).nice();this.options.margin.left=this.calc.calcLeftMargin(this.yAxis,this.options.margin.left);this.xAxisSelection=this.svg.chart.append("g").attr("class","x axis");this.yAxisSelection=this.svg.chart.append("g").attr("class","y axis");this.bars=this.svg.chart.selectAll(".bar").data(this.histogram).enter().append("g").attr("class","bar");this.rects=this.bars.append("rect").attr("x",1);this.options.tooltips&&
(f=this.options.tooltipFormat,d=this.tip||(this.tip=new Tooltip$$module$target$coffeescript$histogram(document)),this.bars.on("mouseover",function(a){d.html(f(a.y));return d.show(this)}));return this.render()};return c}(AbstractChart$$module$target$coffeescript$histogram);var Scales$$module$target$coffeescript$scales,module$target$coffeescript$scales=Scales$$module$target$coffeescript$scales=function(){function d(){}d.fromString=function(c){switch(c){case "linear":return d3.scale.linear();case "log":return d3.scale.log();case "time":return d3.time.scale();case "ordinal":return d3.scale.ordinal()}};return d}();var AbstractChart$$module$target$coffeescript$line_chart,Axes$$module$target$coffeescript$line_chart,LineChart$$module$target$coffeescript$line_chart,MarginCalculator$$module$target$coffeescript$line_chart,Scales$$module$target$coffeescript$line_chart,Tooltip$$module$target$coffeescript$line_chart,defaultLineOptions$$module$target$coffeescript$line_chart,bind$$module$target$coffeescript$line_chart=function(d,c){return function(){return d.apply(c,arguments)}},extend$$module$target$coffeescript$line_chart=
function(d,c){function b(){this.constructor=d}for(var a in c)hasProp$$module$target$coffeescript$line_chart.call(c,a)&&(d[a]=c[a]);b.prototype=c.prototype;d.prototype=new b;d.__super__=c.prototype;return d},hasProp$$module$target$coffeescript$line_chart={}.hasOwnProperty;AbstractChart$$module$target$coffeescript$line_chart=module$target$coffeescript$abstract_chart;Axes$$module$target$coffeescript$line_chart=module$target$coffeescript$axes;MarginCalculator$$module$target$coffeescript$line_chart=module$target$coffeescript$margin_calculator;
Scales$$module$target$coffeescript$line_chart=module$target$coffeescript$scales;Tooltip$$module$target$coffeescript$line_chart=module$target$coffeescript$tooltip;defaultLineOptions$$module$target$coffeescript$line_chart=module$target$coffeescript$defaults.lineOptions;
var module$target$coffeescript$line_chart=LineChart$$module$target$coffeescript$line_chart=function(d){function c(b,a){null==a&&(a={});this.render=bind$$module$target$coffeescript$line_chart(this.render,this);c.__super__.constructor.call(this,b,defaultLineOptions$$module$target$coffeescript$line_chart,a);this.x=Scales$$module$target$coffeescript$line_chart.fromString(this.options.xScale);this.y=Scales$$module$target$coffeescript$line_chart.fromString(this.options.yScale);this.axes=new Axes$$module$target$coffeescript$line_chart(this.svg.chart,
this.x,this.y,this.options,this.axisLabelPadding);"time"===this.options.xScale&&(this.isTimeSeries=!0);this.isTimeSeries&&"string"===typeof this.options.xLabelFormat?this.axes.xAxis.tickFormat(d3.time.format(this.options.xLabelFormat)):this.axes.xAxis.tickFormat(this.options.xLabelFormat);this.axes.yAxis.tickFormat(this.options.yLabelFormat);this.calc=new MarginCalculator$$module$target$coffeescript$line_chart(this.svg);this.line=d3.svg.line().defined(function(a){return null!==a.y});this.area=d3.svg.area().defined(function(a){return null!==
a.y})}extend$$module$target$coffeescript$line_chart(c,d);c.prototype.enterLines=function(b){return b.filter(function(a){return!1!==a.line}).append("path").attr("class",function(a,b){return"line"})};c.prototype.enterAreas=function(b){return b.filter(function(a){return!0===a.area}).append("path").attr("class",function(a,b){return"area"})};c.prototype.createTooltip=function(){var b,a;a=this.tip||(this.tip=new Tooltip$$module$target$coffeescript$line_chart(document));b=this.options.tooltipFormat;this.dots.on("mouseover",
function(c){a.html(b(c.y));return a.show(this)});return this.dots.on("mouseout",function(b){return a.hide()})};c.prototype.render=function(){this.svg.resize();"ordinal"===this.options.xScale?this.x.rangePoints([0,this.svg.width]):this.x.range([0,this.svg.width]);this.y.range([this.svg.height,0]);this.axes.draw(this.svg.width,this.svg.height);this.lines.attr("d",function(b){return function(a){b.line.interpolate(b.chooseInterpolation(a));return b.line(a.values)}}(this));this.areas.attr("d",function(b){return function(a){b.area.interpolate(b.chooseInterpolation(a));
return b.area(a.values)}}(this));return this.dots.attr("cx",function(b){return function(a){return b.x(a.x)}}(this)).attr("cy",function(b){return function(a){return b.y(a.y+a.yTranslation)}}(this))};c.prototype.chooseInterpolation=function(b){return b.smooth?"monotone":"linear"};c.prototype.formatData=function(b,a){var c,d,f,h,m,k,n,e,g,l,y,z,p,q,x,r,t,u,v;null==a&&(a=!1);m=this.isTimeSeries&&"number"===typeof b.labels[0]?b.labels.map(function(a){return new Date(a)}):b.labels;t=r=p=q=null;g=[];n=b.lines;
f=c=0;for(k=n.length;c<k;f=++c)for(h in e=n[f],g.push({values:Array(e.values.length)}),e)l=e[h],"values"!==h&&(g[f][h]=l);f=l=0;for(k=m.length;l<k;f=++l)for(h=m[f],u=c=0,z=b.lines,d=y=0,n=z.length;y<n;d=++y){e=z[d];x=e.values[f];v=x+u;if(null==q||q>h)q=h;if(null==p||p<h)p=h;if(null==t||t>v)t=v;if(null==r||r<v)r=v;d=g[d];null!=e.baselineValues&&(c=e.baselineValues[f]);d.values[f]={x:h,y:x,yTranslation:u,areaY0:c,lineKey:e.label};a&&(u+=x)}return{labels:m,lines:g,xDomain:[q,p],yDomain:["log"===this.options.yScale?
t:0,r]}};c.prototype.draw=function(b){c.__super__.draw.call(this);return this.waitToBeInDom(function(a){return function(){return a.drawInternal(b)}}(this))};c.prototype.drawInternal=function(b){var a,c,d;c=this.formatData(b,this.options.stack);a=c.labels;b=c.lines;d=c.xDomain;c=c.yDomain;"ordinal"===this.options.xScale?this.x.domain(a):this.x.domain(d);this.y.domain(c).nice();this.line.x(function(a){return function(b){return a.x(b.x)}}(this)).y(function(a){return function(b){return a.y(b.y+b.yTranslation)}}(this));
this.area.x(function(a){return function(b){return a.x(b.x)}}(this)).y0(function(a){return function(b){return a.y(b.areaY0+b.yTranslation)}}(this)).y1(function(a){return function(b){return a.y(b.y+b.yTranslation)}}(this));this.options.autoMargins&&(this.options.margin.left=this.calc.calcLeftMargin(this.axes.yAxis,this.options.margin.left));this.lineGroups=this.svg.chart.selectAll(".line").data(b,function(a){return a.label});a=this.lineGroups.enter().append("g").attr("class",function(a,b){return"lineGroup line-"+
b+" "+a.label});this.enterLines(a);this.enterAreas(a);this.lines=this.lineGroups.selectAll(".line");this.areas=this.lineGroups.selectAll(".area");this.dotGroups=this.svg.chart.selectAll(".dotGroup").data(b,function(a){return a.label});this.dotGroups.enter().append("g").attr("class",function(a,b){return"dotGroup line-"+b+" "+a.label});this.dots=this.dotGroups.selectAll(".dot").data(function(a){return function(a){return!1===a.dots?[]:a.values}}(this));this.dots.enter().append("circle").filter(function(a){return null!==
a.y}).attr("class",function(a){return"dot"}).attr("r",this.options.dotSize);this.options.tooltips&&this.createTooltip();return this.render()};return c}(AbstractChart$$module$target$coffeescript$line_chart);var module$target$coffeescript$suave_charts={},m$$module$target$coffeescript$suave_charts;m$$module$target$coffeescript$suave_charts={LineChart:module$target$coffeescript$line_chart,BarChart:module$target$coffeescript$bar_chart,Histogram:module$target$coffeescript$histogram,DonutChart:module$target$coffeescript$donut_chart,GoalsChart:module$target$coffeescript$goals_chart};
(function(d){return d.isBrowser?window.Suave=m$$module$target$coffeescript$suave_charts:d.exports=m$$module$target$coffeescript$suave_charts})("undefined"===typeof module?{isBrowser:!0}:module);})();
